# Post-Mortem

Post-Mortem — это исторический слепок инцидента. Важный документ, в котором участники аварии детально анализируют произошедшее и подробно описывают его контекст. Хороший post-mortem читается как захватывающий приключенческий рассказ с дежурным в главной роли.

Важная часть разбора инцидента — это придерживаться **blameless** культуры. Факапы случаются — это **нормально**.
При разборе инцидента ищут и чинят сломанные процессы. Непокрытые алёртами вещи, незамониторенные фичи, недостатки тестов, недостатки релиз-процесса или любого другого принятого в команде процесса.
Переводить стрелки и искать виноватого — непродуктивно, порождает страх ошибок (а как тогда что-то делать вообще),
а главное, не предотвращает повторение инцидента в будущем. Чините процессы, а не людей.

## Зачем писать
- Чтобы учиться на чужих ошибках: распространение опыта внутри компании;
- Чтобы проводить продуктивный разбор по инцидентам;
- Чтобы лучше продумать план по устранению причин инцидента, используя детальное описание инцидента перед глазами;
- Чтобы использовать как инструкцию к действию в случае повторения инцидента;
- Чтобы видеть **системно повторяющиеся инциденты**.

## Когда писать
Писать для любого инцидента точно не стоит. Есть три ситуации, когда надо написать постмортем:
1. Обязательно для инцидентов
     первого класса 
    критичности;
2. Для любого инцидента по желанию ответственного;
3. Для инцидента второго класса критичности по указанию руководителя разработки.

## Хорошие практики
- Представьте, что постмортем читает разработчик, только пришедший в компанию. Всё ли он поймёт? Чем глубже вы опишите причину инцидента и способы его устранения, тем лучше.
  - Задайте себе пять вопросов «почему?»
- Писать постмортем таким образом, чтобы его можно было использовать как инструкцию для дежурного при повторении инцидента похожего.
- Подсчитывать потери.    
- В план действий, сформулированном после разбора инцидента, стараться устранить *причину* инцидента, а не повысить удобство в работе с уже случившейся аварией.
  - Причём каждый пункт в плане действий должен быть конечной задачей, а не общими формулировками: «улучшить ...», «повысить ...».
  - Задачи при этом должны быть реалистичны. Если не знаете, что можно сделать, лучше так и написать, чем выдумывать воздушные замки.
  - И, естественно, должен сопровождаться ссылкой на тикет с ответственным за его выполнение.
  - ... но если устранить причину вообще никак не получается, надо стараться максимально снизить вред от повторных аварий.
- Уделить особое внимание времени обнаружения. Отрефлексировать, почему не произошло мгновенное реагирование.
- Перечислять в постмортеме компоненты системы, затронутые инцидентом. Это нужно для вычисления зависимостей без graceful degradation.
- Если пишете о каких-то величинах, например, кеш-промахи, давайте конкретные значения и ссылки на графики, по которым вы их поняли! Это будет бесценная информация при повторении аварии.
- Постмортемы должны распространяться настолько широко, насколько это возможно. Одна из целей постмортемов — обучение на чужих ошибках.
- Крайне важно избегать агрессивный тон по отношению коллегам.
- Держать себя в руках на разборе постмортема :)

---
### Ссылки
[Google SRE Workbook — Postmortem Culture: Learning from Failure](https://sre.google/workbook/postmortem-culture/)
[Pager Duty Post Mortem template](https://response.pagerduty.com/after/post_mortem_template/)
